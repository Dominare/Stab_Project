@startuml
start
:Настройка тактирования микроконтроллеоа;
:Настройка портов МК;
:Настройка UART;
:Настройка ADC;
:Запуск ШИМ;
:Запуск ADC в режиме DMA;

repeat

  

    if (В буфере >3 байт) then (Да)
      :Обработка пакета;
      :Отправка ответа;
    endif
    if (Закончено измерение ADC) then (Да)
      :Расчет параметров;
      if (ПИД-регулятор включен) then (Да)
          :Расчет ПИД-регулятора;
          :установка нового значение скавжности ШИМ;
          endif
      :Запуск нового цикла ADC;
    endif


  

repeat while 

@enduml